///////////////////////////////////////////////////////////////////////////////////////
///   File           :         BA_Math.cpp
///   Description    :         Simple mathematical operations.
//////////////////////////////////////////////////////////////////////////////////////

#include "BA_includeFiles.h"
#include "BA_data.h"

//Create Rodrigues rotation from K
void SetRotationMatrix(int i, dtype *k, int idx){

	//Calculate norm of K
	dtype rNorm, cost, sint;
	rNorm = vecNorm(k, 3);

	if (rNorm == 0){
		cost = 0.5; sint = 1;
	}
	else{
		cost = (1 - cos(rNorm)) / (rNorm*rNorm);
		sint = sin(rNorm) / rNorm;
	}

#if defined _RTVector
	R[i][0] = 1 - (cost*((k[1] * k[1]) + (k[2] * k[2])));
	R[i][1] = (-sint*k[2]) + (cost*k[0] * k[1]);
	R[i][2] = (sint*k[1]) + (cost*k[0] * k[2]);
	R[i][3] = (sint*k[2]) + (cost*k[0] * k[1]);
	R[i][4] = 1 - (cost*((k[0] * k[0]) + (k[2] * k[2])));
	R[i][5] = (-sint*k[0]) + (cost*k[1] * k[2]);
	R[i][6] = (-sint*k[1]) + (cost*k[0] * k[2]);
	R[i][7] = (sint*k[0]) + (cost*k[1] * k[2]);
	R[i][8] = 1 - (cost*((k[0] * k[0]) + (k[1] * k[1])));
#endif

#if defined _PVector
	P[idx] = 1 - (cost*((k[1] * k[1]) + (k[2] * k[2])));
	P[idx + 1] = (-sint*k[2]) + (cost*k[0] * k[1]);
	P[idx + 2] = (sint*k[1]) + (cost*k[0] * k[2]);
	P[idx + 3] = (sint*k[2]) + (cost*k[0] * k[1]);
	P[idx + 4] = 1 - (cost*((k[0] * k[0]) + (k[2] * k[2])));
	P[idx + 5] = (-sint*k[0]) + (cost*k[1] * k[2]);
	P[idx + 6] = (-sint*k[1]) + (cost*k[0] * k[2]);
	P[idx + 7] = (sint*k[0]) + (cost*k[1] * k[2]);
	P[idx + 8] = 1 - (cost*((k[0] * k[0]) + (k[1] * k[1])));
#endif

}

void NormalEquations(dtype* Jc, dtype* Jp, int* rowJc, int* colJc, int* rowJp, int* colJp)
{
	//Extract the parameters
	int ptId, camId, cidx, pidx, cId, pId, row0, col0;
	dtype r11, r12, r13, r21, r22, r23, r31, r32, r33, t11, t12, t13, k1, k2, f, x, y, z;

	for (int i = 0; i < num_proj; i++){
		cidx = camidx[i]; pidx = ptidx[i];
		camId = (cidx) * 15; ptId = (num_cam * 15) + ((pidx) * 3);
		r11 = P[camId]; r12 = P[camId + 1]; r13 = P[camId + 2];
		r21 = P[camId + 3]; r22 = P[camId + 4]; r23 = P[camId + 5];
		r31 = P[camId + 6]; r32 = P[camId + 7]; r33 = P[camId + 8];
		t11 = P[camId + 9]; t12 = P[camId + 10]; t13 = P[camId + 11];
		f = P[camId + 12]; k1 = P[camId + 13]; k2 = P[camId + 14];
		x = P[ptId]; y = P[ptId + 1]; z = P[ptId + 2];

		//Equations
		cId = 30 * i; row0 = (pidx*(num_cam * 2)) + (2 * cidx); col0 = (cidx * 15);
		Jc[cId + 0] = (-(f*((2 * k1*x*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 0] = row0; colJc[cId + 0] = col0;
		Jc[cId + 1] = (-(f*((2 * k1*y*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 1] = row0; colJc[cId + 1] = col0 + 1;
		Jc[cId + 2] = (-(f*((2 * k1*z*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 2] = row0; colJc[cId + 2] = col0 + 2;
		Jc[cId + 3] = (-(f*((2 * k1*x*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 3] = row0; colJc[cId + 3] = col0 + 3;
		Jc[cId + 4] = (-(f*((2 * k1*y*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 4] = row0; colJc[cId + 4] = col0 + 4;
		Jc[cId + 5] = (-(f*((2 * k1*z*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 5] = row0; colJc[cId + 5] = col0 + 5;
		Jc[cId + 6] = ((f*(k1*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 6] = row0; colJc[cId + 6] = col0 + 6;
		Jc[cId + 7] = ((f*(k1*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 7] = row0; colJc[cId + 7] = col0 + 7;
		Jc[cId + 8] = ((f*(k1*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 8] = row0; colJc[cId + 8] = col0 + 8;
		Jc[cId + 9] = (-(f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z) - (f*((k1*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 9] = row0; colJc[cId + 9] = col0 + 9;
		Jc[cId + 10] = (-(f*((k1*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 10] = row0; colJc[cId + 10] = col0 + 10;
		Jc[cId + 11] = ((f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (f*(k1*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 11] = row0; colJc[cId + 11] = col0 + 11;
		Jc[cId + 12] = (-((k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 12] = row0; colJc[cId + 12] = col0 + 12;
		Jc[cId + 13] = (-(f*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 13] = row0; colJc[cId + 13] = col0 + 13;
		Jc[cId + 14] = (-(f*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) * (t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 14] = row0; colJc[cId + 14] = col0 + 14;

		row0 = row0 + 1;
		Jc[cId + 15] = (-(f*((2 * k1*x*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 15] = row0; colJc[cId + 15] = col0 + 0;
		Jc[cId + 16] = (-(f*((2 * k1*y*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 16] = row0; colJc[cId + 16] = col0 + 1;
		Jc[cId + 17] = (-(f*((2 * k1*z*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 17] = row0; colJc[cId + 17] = col0 + 2;
		Jc[cId + 18] = (-(f*((2 * k1*x*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 18] = row0; colJc[cId + 18] = col0 + 3;
		Jc[cId + 19] = (-(f*((2 * k1*y*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 19] = row0; colJc[cId + 19] = col0 + 4;
		Jc[cId + 20] = (-(f*((2 * k1*z*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 20] = row0; colJc[cId + 20] = col0 + 5;
		Jc[cId + 21] = ((f*(k1*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 21] = row0; colJc[cId + 21] = col0 + 6;
		Jc[cId + 22] = ((f*(k1*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 22] = row0; colJc[cId + 22] = col0 + 7;
		Jc[cId + 23] = ((f*(k1*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		rowJc[cId + 23] = row0; colJc[cId + 23] = col0 + 8;
		Jc[cId + 24] = (-(f*((k1*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 24] = row0; colJc[cId + 24] = col0 + 9;
		Jc[cId + 25] = (-(f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z) - (f*((k1*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 25] = row0; colJc[cId + 25] = col0 + 10;
		Jc[cId + 26] = ((f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (f*(k1*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 26] = row0; colJc[cId + 26] = col0 + 11;
		Jc[cId + 27] = (-((k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 27] = row0; colJc[cId + 27] = col0 + 12;
		Jc[cId + 28] = (-(f*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 28] = row0; colJc[cId + 28] = col0 + 13;
		Jc[cId + 29] = (-(f*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) * (t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		rowJc[cId + 29] = row0; colJc[cId + 29] = col0 + 14;

		pId = 6 * i; row0 = (pidx*(num_cam * 2)) + (2 * cidx); col0 = pidx * 3;
		Jp[pId + 0] = ((f*r31*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r11*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 0] = row0; colJp[pId + 0] = col0 + 0;
		Jp[pId + 1] = ((f*r32*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r12*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 1] = row0; colJp[pId + 1] = col0 + 1;
		Jp[pId + 2] = ((f*r33*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r13*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 2] = row0; colJp[pId + 2] = col0 + 2;
		
		row0 = row0 + 1;
		Jp[pId + 3] = ((f*r31*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r21*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 3] = row0; colJp[pId + 3] = col0 + 0;
		Jp[pId + 4] = ((f*r32*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r22*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 4] = row0; colJp[pId + 4] = col0 + 1;
		Jp[pId + 5] = ((f*r33*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r23*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		rowJp[pId + 5] = row0; colJp[pId + 5] = col0 + 2;

		/*
		//Equations
		J[i].Aij[0][0] = (-(f*((2 * k1*x*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][1] = (-(f*((2 * k1*y*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][2] = (-(f*((2 * k1*z*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][3] = (-(f*((2 * k1*x*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][4] = (-(f*((2 * k1*y*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][5] = (-(f*((2 * k1*z*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][6] = ((f*(k1*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[0][7] = ((f*(k1*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[0][8] = ((f*(k1*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) + (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[0][9] = (-(f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z) - (f*((k1*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][10] = (-(f*((k1*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][11] = ((f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (f*(k1*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][12] = (-((k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][13] = (-(f*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[0][14] = (-(f*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) * (t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[0][0] = ((f*r31*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r11*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[0][1] = ((f*r32*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r12*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[0][2] = ((f*r33*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t11 + r11*x + r12*y + r13*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r13*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));

		J[i].Aij[1][0] = (-(f*((2 * k1*x*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][1] = (-(f*((2 * k1*y*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][2] = (-(f*((2 * k1*z*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][3] = (-(f*((2 * k1*x*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*x*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][4] = (-(f*((2 * k1*y*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*y*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][5] = (-(f*((2 * k1*z*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (4 * k2*z*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][6] = ((f*(k1*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * x*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * x*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*x*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[1][7] = ((f*(k1*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * y*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * y*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*y*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[1][8] = ((f*(k1*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*((2 * z*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * z*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) + (f*z*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)));
		J[i].Aij[1][9] = (-(f*((k1*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t11 + 2 * r11*x + 2 * r12*y + 2 * r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][10] = (-(f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z) - (f*((k1*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(2 * t12 + 2 * r21*x + 2 * r22*y + 2 * r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][11] = ((f*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (f*(k1*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * ((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][12] = (-((k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][13] = (-(f*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Aij[1][14] = (-(f*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) * (t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[1][0] = ((f*r31*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r11*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r21*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r31*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r21*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[1][1] = ((f*r32*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r12*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r22*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r32*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r22*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		J[i].Bij[1][2] = ((f*r33*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (f*(k1*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + 2 * k2*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*((2 * r13*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + (2 * r23*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) - (2 * r33*((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z))) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))))*(t12 + r21*x + r22*y + r23*z)) / (t13 + r31*x + r32*y + r33*z) - (f*r23*(k1*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z))) + k2*((((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))*(((t11 + r11*x + r12*y + r13*z)*(t11 + r11*x + r12*y + r13*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)) + ((t12 + r21*x + r22*y + r23*z)*(t12 + r21*x + r22*y + r23*z)) / ((t13 + r31*x + r32*y + r33*z)*(t13 + r31*x + r32*y + r33*z)))) + 1)) / (t13 + r31*x + r32*y + r33*z));
		*/
		/*if (i == 10){
		cout << J[i].Aij[0][0] << "\t" << J[i].Bij[1][1] << endl;
		}*/
	}
}

dtype maxUDiagonal()
{
	dtype maxU; int Id;
	maxU = U[0];

	for (int i = 0; i < num_cam; i++){
		for (int j = 0; j < 15; j++){
			Id = (i * 225) + (16 * j);
			if (maxU < U[Id]){
				maxU = U[Id];
			}
		}
	}

	return maxU;
}

dtype maxVDiagonal()
{
	dtype maxV; int Id;
	maxV = V[0];
	for (int i = 0; i < num_pt; i++){
		for (int j = 0; j < 3; j++){
			Id = (i * 9) + (4 * j);
			if (maxV < V[Id]){
				maxV = V[Id];
			}
		}
	}

	return maxV;
}

void invVCalculation()
{
	for (int i = 0; i < num_pt; i++){
		invCalculation(V + (i * 9));
	}
}